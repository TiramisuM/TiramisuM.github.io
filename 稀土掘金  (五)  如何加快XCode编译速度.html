<html>
<head>
  <title>稀土掘金  (五) : 如何加快XCode编译速度</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/307027 (zh-CN, DDL); Windows/10.0.0 (Win64);"/>
  <meta name="application-data:corenote-hostUUID" content="C8940BC2-A53C-4B55-B59C-4779464BC778"/>
  <meta name="application-data:corenote-localUUID" content="484D8DFE-11EF-45E3-85AD-D3723D036099"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1567"/>
<h1>稀土掘金  (五) : 如何加快XCode编译速度</h1>

<div>
<span><div>1. 增加XCode执行的线程数</div><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">可以根据自己Mac的性能，更改线程数设置5：defaults write com.apple.Xcode PBXNumberOfParallelBuildSubtasks 5</span></div><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">另外也有一个设置可以开启：defaults write com.apple.dt.Xcode ShowBuildOperationDuration YES</span></div><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">XCode默认使用与CPU核数相同的线程来进行编译，但由于编译过程中的IO操作往往比CPU运算要多，因此适当的提升线程数可以在一定程度上加快编译速度。</span></div><div style="text-align: center; -en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><img src="稀土掘金  (五)  如何加快XCode编译速度_files/Image.png" type="image/png" data-filename="Image.png"/><br/></div><h2>2.将Debug Information Format改为DWARF</h2><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">在工程对应Target的Build Settings中，找到Debug Information Format这一项，将Debug时的DWARF with dSYM file改为DWARF。</span></div><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">如图：</span></div><div style="text-align: center; -en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><img src="稀土掘金  (五)  如何加快XCode编译速度_files/Image [1].png" type="image/png" data-filename="Image.png"/><br/></div><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em; font-weight: bold;">这一项设置的是是否将调试信息加入到可执行文件中，改为DWARF后，如果程序崩溃，将无法输出崩溃位置对应的函数堆栈，但由于Debug模式下可以在XCode中查看调试信息，所以改为DWARF影响并不大。这一项更改完之后，可以大幅提升编译速度。</span></div><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">比如在目前本人负责的项目中，由于依赖了多个Target，所以需要在每个Target的Debug Information Format设置为DWARF。</span><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em; font-weight: bold;">顺便提一下，如果通过</span><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em; font-weight: bold;">Cocoapod</span><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em; font-weight: bold;">引入第三方则</span><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em; font-weight: bold;">Debug Information Format</span><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em; font-weight: bold;">默认就是设置为</span><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em; font-weight: bold;">DWARF</span><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em; font-weight: bold;">的。</span></div><ul><li>SDWebImage通过Cocoapod``Debug Information Format的默认设置<br/><img src="稀土掘金  (五)  如何加快XCode编译速度_files/Image [2].png" type="image/png" data-filename="Image.png"/><br/></li></ul><blockquote><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">注意：将Debug Information Format改为DWARF之后，会导致在Debug窗口无法查看相关类类型的成员变量的值。当需要查看这些值时，可以将Debug Information Format改回DWARF with dSYM file，clean（必须）之后重新编译即可。</span></div></blockquote><h2>3.将Build Active Architecture Only改为Yes</h2><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">在工程对应Target的Build Settings中，找到Build Active Architecture Only这一项，将Debug时的NO改为Yes。</span></div><div style="text-align: center; -en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><img src="稀土掘金  (五)  如何加快XCode编译速度_files/Image [3].png" type="image/png" data-filename="Image.png"/><br/></div><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">这一项设置的是是否仅编译当前架构的版本，如果为NO，会编译所有架构的版本。</span><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em; font-weight: bold;">需要注意的是，此选项在</span><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em; font-weight: bold;">Release</span><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em; font-weight: bold;">模式下必须为NO`，否则发布的ipa在部分设备上将不能运行。这一项更改完之后，可以显著提高编译速度。</span></div><h2>4.设计编译优化等级</h2><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">不要再项目中或者静态库中使用-O4，因为这会让Clang链接Link Time Optimizations (LTO)使得编译更慢，通常使用-O3。</span></div><div style="text-align: center; -en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><img src="稀土掘金  (五)  如何加快XCode编译速度_files/Image [4].png" type="image/png" data-filename="Image.png"/><br/></div><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em; font-weight: bold;">注意：在设置编译优化之后，XCode断点和调试信息会不正常，所以一般静态库或者其他</span><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em; font-weight: bold;">Target</span><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em; font-weight: bold;">这样设置。</span></div><h2>4.资源整合</h2><h3><span style="font-size: 16px;">4.1 将常用的代码及文件打包成静态库</span></h3><h3><span style="font-size: 16px;">4.2 添加预编译文件，把常用的头文件放到预编译文件里面</span></h3><div><span style="font-size: 16px;">4.3 能用</span><span style="font-size: 16px;">@class</span><span style="font-size: 16px;">就用</span><span style="font-size: 16px;">@class</span></div><div><br/></div><div><br/></div><div><span style="direction: ltr; font-family: SimSun; color: rgb(79, 129, 189); margin-top: 1em; margin-bottom: 1em; unicode-bidi: embed; font-size: 10.5pt; -en-paragraph: true; border-width: 100%; font-weight: bold;">笔记整理：Edison</span></div><div style="direction: ltr; font-family: Menlo; font-size: 10.5pt; -en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="direction: ltr; font-family: SimSun; font-size: 10.5pt; -en-paragraph: true; margin-top: 1em; margin-bottom: 1em; border-width: 100%; font-weight: bold; color: rgb(79, 129, 189); unicode-bidi: embed;">联系方式：QQ：277593 （笔记意见建议可加此Q，专人更新此笔记）；</span></div><div style="direction: ltr; font-family: Menlo; font-size: 10.5pt; -en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="direction: ltr; font-family: SimSun; font-size: 10.5pt; -en-paragraph: true; margin-top: 1em; margin-bottom: 1em; border-width: 100%; color: rgb(79, 129, 189); unicode-bidi: embed;"> </span></div><div><span style="direction: ltr; font-family: SimSun; color: rgb(79, 129, 189); margin-top: 1em; margin-bottom: 1em; unicode-bidi: embed; font-size: 10.5pt; -en-paragraph: true; border-width: 100%; font-weight: bold;">注：小道途径获取到的笔记，无法自动更新，请谅解！(笔记平均每月更新一次，祝各位都能拿到心仪的offer)</span><span style="direction: ltr; font-family: SimSun; color: rgb(79, 129, 189); margin-top: 1em; margin-bottom: 1em; unicode-bidi: embed; font-size: 10.5pt; -en-paragraph: true; border-width: 100%;"> </span></div><div><br/></div></span>
</div></body></html> 