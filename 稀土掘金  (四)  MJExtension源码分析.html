<html>
<head>
  <title>ç¨€åœŸæ˜é‡‘Â  (å››) : MJExtensionæºç åˆ†æ</title>
  <basefont face="å¾®è½¯é›…é»‘" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/307027 (zh-CN, DDL); Windows/10.0.0 (Win64);"/>
  <meta name="application-data:corenote-hostUUID" content="C8940BC2-A53C-4B55-B59C-4779464BC778"/>
  <meta name="application-data:corenote-localUUID" content="2B283A02-6214-401D-988D-17E104D03AA3"/>
  <style>
    body, td {
      font-family: å¾®è½¯é›…é»‘;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1573"/>
<h1>ç¨€åœŸæ˜é‡‘Â  (å››) : MJExtensionæºç åˆ†æ</h1>

<div>
<span><div>A fast, convenient and nonintrusive conversion between JSON and model.</div><div>è½¬æ¢é€Ÿåº¦å¿«ã€ä½¿ç”¨ç®€å•æ–¹ä¾¿çš„å­—å…¸è½¬æ¨¡å‹æ¡†æ¶</div><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">æ€»ä½“æ¥è¯´ï¼šä¸Šæ‰‹å¿«ï¼Œä½¿ç”¨ç®€å•ã€‚</span></div><div><img src="ç¨€åœŸæ˜é‡‘  (å››)  MJExtensionæºç åˆ†æ_files/Image.png" type="image/png" data-filename="Image.png"/><br/></div><h2>å…³é”®ç±»</h2><pre><code><font color="#0433ff"><span>#import &quot;NSObject+MJCoding.h&quot;</span><br/><span>#import &quot;NSObject+MJProperty.h&quot;</span><br/><span>#import &quot;NSObject+MJClass.h&quot;</span><br/><span>#import &quot;NSObject+MJKeyValue.h&quot;</span><br/><span>#import &quot;NSString+MJExtension.h&quot;</span><br/><span>#import &quot;MJExtensionConst.h&quot;</span></font></code></pre><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">é™¤æ­¤ä¹‹å¤–è¿˜æœ‰ä¸€äº›è¾…åŠ©ç±»ï¼Œæ¯”å¦‚ï¼šMJFoundation.hã€MJProperty.hã€MJPropertyKey.hã€MJPropertyType.hã€‚</span></div><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">æ ¹æ®ç±»çš„åå­—ï¼Œå¤§è‡´å°±èƒ½çŒœåˆ°æ˜¯ç”¨æ¥åšä»€ä¹ˆç”¨çš„ã€‚æˆ‘ä»¬å…ˆä»æœ€ç®€å•çš„å¼€å§‹åˆ†æã€‚</span></div><h2>MJExtensionConst</h2><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">è¿™é‡Œå®šä¹‰äº†æ•´ä¸ªåº“çš„å¸¸é‡å’Œå®å®šä¹‰ã€‚ç±»ä¼¼äºä¸€ä¸ªé¡¹ç›®ä¸­çš„é¢„ç¼–è¯‘æ–‡ä»¶ã€‚åŒ…å«äº†æ–¹æ³•å¼ƒç”¨å®ï¼Œè‡ªå®šä¹‰Logæ—¥å¿—ã€è‡ªå®šä¹‰æ–­è¨€ã€å¿«é€Ÿæ‰“å°æ‰€æœ‰å±æ€§ã€è‡ªå®šä¹‰ç±»å‹ç¼–ç å­—ç¬¦ä¸²å¸¸é‡</span></div><ul><li>æ–¹æ³•å¼ƒç”¨ï¼šä¸€èˆ¬åœ¨åšé¡¹ç›®ä¸­æ¯”è¾ƒå°‘ç”¨åˆ°ï¼ŒåšSDKç”¨åˆ°çš„æœºä¼šæ¯”è¾ƒå¤§ã€‚#define MJExtensionDeprecated(instead) NS_DEPRECATED(2_0, 2_0, 2_0, 2_0, instead)å¯èƒ½å¥½å¤šåŒå­¦å¯¹è¿™é‡Œçš„2_0ä¸æ˜¯å¾ˆæ‡‚ã€‚è¿™é‡Œç®€å•æ‰©å±•ä¸€ä¸‹ï¼š<br/>ä¸€ã€NS_AVAILABEL_IOS<br/>ä¾‹å¦‚ï¼š</li><li>(void)presentViewController:(UIViewController *)viewControllerToPresent animated: (BOOL)flag completion:(void (^)(void))completion NS_AVAILABLE_IOS(5_0);<br/>è¯¥NS_AVAILABLE_IOS(5_0)å‘Šè¯‰æˆ‘ä»¬è¿™ä¸ªæ–¹æ³•å¯ä»¥åœ¨iOS5.0åŠä»¥åçš„ç‰ˆæœ¬ä¸­ä½¿ç”¨ã€‚å¦‚æœæˆ‘ä»¬åœ¨æ¯”æŒ‡å®šç‰ˆæœ¬æ›´è€çš„ç‰ˆæœ¬ä¸­è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œå°±ä¼šå¼•èµ·å´©æºƒã€‚<br/>äºŒã€NS_AVAILABLE<br/><span style="color: rgb(4, 51, 255);">- (void)setObject:(id)obj atIndexedSubscript:(NSUInteger)idx NS_AVAILABLE(10_8, 6_0);</span><br/>è¿™é‡Œçš„NS_AVAILABLEå®å‘Šè¯‰æˆ‘ä»¬è¿™æ–¹æ³•åˆ†åˆ«éšMac OS 10.8å’ŒiOS 6.0è¢«å¼•å…¥ã€‚<br/>ä¸‰ã€NS_DEPRECATED_IOS<br/>ä¾‹å¦‚ï¼š</li><ul><li>(void)presentModalViewController:(UIViewController *)modalViewController animated:(BOOL)animated NS_DEPRECATED_IOS(2_0, 6_0);<br/>NS_DEPRECATED_IOS(2_0, 6_0)<br/>è¿™é‡Œçš„å®æœ‰ä¸¤ä¸ªç‰ˆæœ¬å·ï¼Œå‰é¢ä¸€ä¸ªè¡¨æ˜äº†è¿™ä¸ªæ–¹æ³•è¢«å¼•å…¥æ—¶çš„iOSç‰ˆæœ¬ï¼Œåé¢ä¸€ä¸ªè¡¨åå®ƒè¢«åºŸå¼ƒæ—¶çš„iOSç‰ˆæœ¬ã€‚æœ¬åºŸå¼ƒå¹¶ä¸æ˜¯æŒ‡è¿™ä¸ªæ–¹æ³•å°±ä¸å­˜åœ¨äº†ï¼ŒçŸ¥è¯†æ„å‘³ç€æˆ‘ä»¬åº”å½“å¼€å§‹è€ƒè™‘å°†ç›¸å…³ä»£ç è¿ç§»åˆ°æ–°çš„APIä¸Šå»äº†ã€‚<br/>å››ã€NS_DEPRECATED<br/>ä¾‹å¦‚ï¼š</li></ul><li>(void)removeObjectsFromIndices:(NSUInteger *)indices numIndices:(NSUInteger)cnt NS_DEPRECATED(10_0, 10_6, 2_0, 4_0);<br/>è¿™é‡Œè¡¨ç¤ºè¿™ä¸ªæ–¹æ³•è™½Max OS 10.0å’ŒiOS 2.0è¢«å¼•å…¥ï¼Œåœ¨Mac OS 10.6å’ŒiOS 4.0åèƒŒåºŸå¼ƒã€‚<br/>`` æ ¹æ®ä¸Šé¢çš„è§£é‡Šï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“è¿™é‡Œçš„#define MJExtensionDeprecated(instead) NS_DEPRECATED(2_0, 2_0, 2_0, 2_0, instead)`ä»£ç åœ¨Max OS 2.0å’ŒiOS 2.0è¢«å¼•å…¥ï¼Œåœ¨Mac OS 2.0å’ŒiOS 2.0åèƒŒåºŸå¼ƒã€‚æ˜¯ä¸æ˜¯æœ‰ä»€ä¹ˆä¸å¯¹ï¼Ÿï¼ŸğŸ˜’ğŸ˜’</li><li>å®å®šä¹‰å‡½æ•°ï¼ˆæ—¥å¿—è¾“å‡ºï¼Œæ„å»ºé”™è¯¯ç­‰ï¼‰ï¼šçœ‹ä¸€ä¸ªæ–­è¨€çš„ä¾‹å­<br/><span style="color: rgb(4, 51, 255);">#define MJExtensionAssertError(condition, returnValue, clazz, msg) </span><br/><span style="color: rgb(4, 51, 255);">[clazz setMj_error:nil]; </span><br/><span style="color: rgb(4, 51, 255);">if ((condition) == NO) { </span><br/><span style="color: rgb(4, 51, 255);">Â  MJExtensionBuildError(clazz, msg); </span><br/><span style="color: rgb(4, 51, 255);">Â  return returnValue;</span><br/><span style="color: rgb(4, 51, 255);">}</span><br/>æœ‰ä¸€ä¸ªç»†èŠ‚(condition)ï¼Œè¿™é‡Œä¸ºä»€ä¹ˆè¦ç”¨ï¼ˆconditionï¼‰å¤šåŠ ä¸€å¯¹æ‹¬å·ï¼Œå› ä¸ºconditionhæ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œä¸ºäº†ä¿è¯æ‰§è¡Œé¡ºåºã€‚<br/>è¿™ç§ç‰¹æ€§æ˜¯ä»cè¯­è¨€ç§»æ¤è¿‡æ¥çš„ï¼Œåœ¨å®å®šä¹‰æ¯è¡Œæœ€ååŠ ä¸Šæ–œæ ``ï¼Œè¡¨ç¤ºå®å®šä¹‰å‡½æ•°ï¼Œå¦‚æœæœ‰å‚æ•°å¯ä»¥æŒ‰ç…§ä¸Šé¢çš„ä¾‹å­è¿›è¡Œä¼ é€’ã€‚</li><li>æœ€åæ¥çœ‹ä¸€çœ‹ç±»å‹ç¼–ç ï¼šå¤§è‡´æ ¹æ®åç§°å°±çŸ¥é“ç¬¦å·ä»£è¡¨ä»€ä¹ˆç±»å‹çš„å‚æ•°<br/><span style="color: rgb(4, 51, 255);">NSString *const MJPropertyTypeInt = @&quot;i&quot;;</span><br/><span style="color: rgb(4, 51, 255);">NSString *const MJPropertyTypeShort = @&quot;s&quot;;</span><br/><span style="color: rgb(4, 51, 255);">NSString *const MJPropertyTypeFloat = @&quot;f&quot;;</span><br/><span style="color: rgb(4, 51, 255);">NSString *const MJPropertyTypeDouble = @&quot;d&quot;;</span><br/><span style="color: rgb(4, 51, 255);">NSString *const MJPropertyTypeLong = @&quot;l&quot;;</span><br/><span style="color: rgb(4, 51, 255);">NSString *const MJPropertyTypeLongLong = @&quot;q&quot;;</span><br/><span style="color: rgb(4, 51, 255);">NSString *const MJPropertyTypeChar = @&quot;c&quot;;</span><br/><span style="color: rgb(4, 51, 255);">NSString *const MJPropertyTypeBOOL1 = @&quot;c&quot;;</span><br/><span style="color: rgb(4, 51, 255);">NSString *const MJPropertyTypeBOOL2 = @&quot;b&quot;;</span><br/><span style="color: rgb(4, 51, 255);">NSString *const MJPropertyTypePointer = @&quot;*&quot;;</span><br/><span style="color: rgb(4, 51, 255);">NSString *const MJPropertyTypeIvar = @&quot;^{objc_ivar=}&quot;;</span><br/><span style="color: rgb(4, 51, 255);">NSString *const MJPropertyTypeMethod = @&quot;^{objc_method=}&quot;;</span><br/><span style="color: rgb(4, 51, 255);">NSString *const MJPropertyTypeBlock = @&quot;@?&quot;;</span><br/><span style="color: rgb(4, 51, 255);">NSString *const MJPropertyTypeClass = @&quot;#&quot;;</span><br/><span style="color: rgb(4, 51, 255);">NSString *const MJPropertyTypeSEL = @&quot;:&quot;;</span><br/><span style="color: rgb(4, 51, 255);">NSString *const MJPropertyTypeId = @&quot;@&quot;;</span></li></ul><h2>MJFoundation.h</h2><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">è¿™ä¸ªç±»åšçš„äº‹æƒ…å°±æ˜¯åˆ¤æ–­ç±»æ˜¯ä¸æ˜¯å±äºFoundationæ¡†æ¶é‡Œé¢çš„ã€‚å¯èƒ½å¾ˆå¥½å¥‡å¦‚ä½•åˆ¤æ–­è¿™ä¸ªç±»æ˜¯ä¸æ˜¯Foundationæ¡†æ¶å‘¢ã€‚è¿™é‡Œç”¨çš„æ˜¯ç©·ä¸¾æ³•ï¼Œç”±äºæ¡†æ¶é‡Œé¢çš„ç±»å¤ªå¤šã€‚è¿™é‡Œå°±æŠŠæœ€åå¸¸ç”¨çš„å‡ ä¸ªç±»è¿›è¡Œåˆ¤æ–­ã€‚å¦‚ä¸‹ï¼š</span></div><pre><code> <font color="#0433ff">foundationClasses_ = [NSSet setWithObjects:<br/>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  [NSURL <span>class],<br/></span>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  [NSDate <span>class],<br/></span>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  [NSValue <span>class],<br/></span>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  [NSData <span>class],<br/></span>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  [NSError <span>class],<br/></span>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  [NSArray <span>class],<br/></span>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  [NSDictionary <span>class],<br/></span>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  [NSString <span>class],<br/></span>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  [NSAttributedString <span>class], nil];</span></font></code></pre><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">ç„¶ååˆ¤æ–­</span></div><pre><code><font color="#0433ff">+ (BOOL)isClassFromFoundation:(Class)c<br/>{<br/>Â Â Â  if (c == [NSObject class] || c == [NSManagedObject class]) return YES;<br/><br/>Â Â Â  __block BOOL result = NO;<br/>Â Â Â  [[self foundationClasses] enumerateObjectsUsingBlock:^(Class foundationClass, BOOL *stop) {<br/>Â Â Â Â Â Â Â  if ([c isSubclassOfClass:foundationClass]) {<br/>Â Â Â Â Â Â Â Â Â Â Â  result = YES;<br/>Â Â Â Â Â Â Â Â Â Â Â  *stop = YES;<br/>Â Â Â Â Â Â Â  }<br/>Â Â Â  }];<br/>Â Â Â  return result;<br/>}</font></code></pre><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">è¿™é‡ŒåŠ __blockæ˜¯ä¸ºäº†åœ¨blockå†…éƒ¨å¯ä»¥ä¿®æ”¹result.</span></div><h2>NSString+MJExtension.h</h2><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">è¿™ä¸ªç±»ä½œç”¨å°±æ˜¯å¯¹å­—ç¬¦ä¸²çš„ä¸€äº›æ“ä½œï¼Œæ¯”å¦‚å˜é‡çš„å‘½åæ–¹æ³•è½¬æ¢ã€‚å¸¸è§çš„é©¼å³°è½¬ä¸‹åˆ’çº¿ï¼ˆloveYou -&gt; love_youï¼‰ã€ä¸‹åˆ’çº¿è½¬é©¼å³°ï¼ˆlove_you -&gt; loveYouï¼‰ã€é¦–å­—æ¯å˜å¤§å†™ã€é¦–å­—æ¯å˜å°å†™ã€æ˜¯ä¸æ˜¯æ•´å½¢ã€æ˜¯ä¸æ˜¯URLæ ¼å¼</span></div><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em; font-weight: bold;">å…¶å®å°±æ˜¯ä¸€ä¸ªå·¥å…·åˆ†ç±»,æ“ä½œå˜é‡æˆ–è€…å±æ€§å</span></div><h2>MJPropertyTypeï¼ˆåŸºç¡€ç±»å‹ï¼‰</h2><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">å¯¹å±æ€§çš„å…·ä½“ç±»å‹è¿›è¡Œå°è£…ï¼Œç®€å•æ¥è¯´å°±æ˜¯è®²ç±»å‹ç¼–ç è½¬ä¸ºæˆ‘ä»¬ç†ŸçŸ¥çš„ç±»å‹ã€‚æš´éœ²ç»™å¤–é¢ä½¿ç”¨ï¼Œå…¶å±æ€§å¦‚ä¸‹ï¼š</span></div><pre><code><font color="#0433ff">/** ç±»å‹æ ‡è¯†ç¬¦ï¼Œç±»å‹ç¼–ç  */<br/>@property (nonatomic, copy) NSString *code;<br/><br/>/** æ˜¯å¦ä¸ºidç±»å‹ */<br/>@property (nonatomic, readonly, getter=isIdType) BOOL idType;<br/><br/>/** æ˜¯å¦ä¸ºåŸºæœ¬æ•°å­—ç±»å‹ï¼šintã€floatç­‰ */<br/>@property (nonatomic, readonly, getter=isNumberType) BOOL numberType;<br/><br/>/** æ˜¯å¦ä¸ºBOOLç±»å‹ */<br/>@property (nonatomic, readonly, getter=isBoolType) BOOL boolType;<br/><br/>/** å¯¹è±¡ç±»å‹ï¼ˆå¦‚æœæ˜¯åŸºæœ¬æ•°æ®ç±»å‹ï¼Œæ­¤å€¼ä¸ºnilï¼‰ */<br/>@property (nonatomic, readonly) Class typeClass;<br/><br/>/** ç±»å‹æ˜¯å¦æ¥è‡ªäºFoundationæ¡†æ¶ï¼Œæ¯”å¦‚NSStringã€NSArray */<br/>@property (nonatomic, readonly, getter = isFromFoundation) BOOL fromFoundation;<br/>/** ç±»å‹æ˜¯å¦ä¸æ”¯æŒKVC */<br/>@property (nonatomic, readonly, getter = isKVCDisabled) BOOL KVCDisabled;</font></code></pre><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em; color: rgb(4, 51, 255);">é€šè¿‡ç±»æ–¹æ³•åˆå§‹åŒ–</span><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em; color: rgb(4, 51, 255);">+ (instancetype)cachedTypeWithCode:(NSString *)code</span><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em; color: rgb(4, 51, 255);">ã€‚</span></div><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em; font-weight: bold;">å› ä¸ºæ€»å…±çš„ç±»å‹å°±å¦‚ä¸Šæåˆ°çš„é‚£å‡ ç§ï¼Œæ‰€ä»¥è¿™é‡Œç”¨äº†ä¸€ä¸ªé™æ€çš„å­—å…¸ä¿å­˜ç»“æœã€‚ä¸‹æ¬¡ç›´æ¥ä»ç»“æœä¸­å–ï¼Œå¦‚æœæœ‰åˆ™ä¸ç”¨ä¾æ¬¡åˆ¤æ–­äº†</span></div><pre><code>static NSMutableDictionary *types_; é™æ€å­—å…¸<br/>+ (void)initialize<br/>{<br/>Â Â Â  types_ = [NSMutableDictionary dictionary];<br/>}</code></pre><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">æ³¨æ„è¿™é‡Œçš„initializeï¼Œå¦‚æœä½ å¯¹Swizzleç†Ÿæ‚‰ï¼Œé‚£ä¹ˆloadåº”è¯¥çŸ¥é“ã€‚é¡ºä¾¿å°±æä¸‹ä¸¤è€…çš„åŒºåˆ«ã€‚</span></div><table><thead><tr><td><div>å¯¹æ¯”ç‚¹</div></td><td><div>+(void)load</div></td><td><div>+(void)initialize</div></td></tr></thead><tbody><tr><td style="text-align: center;"><div>æ‰§è¡Œæ—¶æœº </div></td><td style="text-align: center;"><div>åœ¨ç¨‹åºè¿è¡Œåç«‹å³æ‰§è¡Œ </div></td><td style="text-align: center;"><div>åœ¨ç±»çš„æ–¹æ³•ç¬¬ä¸€æ¬¡è¢«è°ƒæ—¶æ‰§è¡Œ </div></td></tr><tr><td style="text-align: center;"><div>è‹¥è‡ªèº«æœªå®šä¹‰ï¼Œæ˜¯å¦æ²¿ç”¨çˆ¶ç±»çš„æ–¹æ³•ï¼Ÿ </div></td><td style="text-align: center;"><div>å¦ </div></td><td style="text-align: center;"><div>æ˜¯ </div></td></tr><tr><td style="text-align: center;"><div>ç±»åˆ«ä¸­çš„å®šä¹‰ </div></td><td style="text-align: center;"><div>å…¨éƒ½æ‰§è¡Œï¼Œä½†åäºç±»ä¸­çš„æ–¹æ³• </div></td><td style="text-align: center;"><div>è¦†ç›–ç±»ä¸­çš„æ–¹æ³•ï¼Œåªæ‰§è¡Œä¸€ä¸ª </div></td></tr></tbody></table><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">é‚£ç¼“å­˜æ€ä¹ˆå®ç°çš„å‘¢ï¼Ÿ</span></div><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">ä¸€èˆ¬ç¼“å­˜çš„æ€è·¯éƒ½ä¸€æ ·ï¼šåœ¨ç¬¬ä¸€æ¬¡ä½¿ç”¨çš„æ—¶å€™ä¿å­˜ç»“æœã€‚å¦‚æœä»¥åæœ‰ç›¸åŒçš„æƒ…å†µåˆ™ç›´æ¥ä»ä»¥å‰çš„ç»“æœä¸­è¿”å›å°±å¯ä»¥äº†ã€‚</span></div><pre><code><font color="#0433ff">+ (instancetype)cachedTypeWithCode:(NSString *)code<br/>{<br/>Â Â Â  MJExtensionAssertParamNotNil2(code, nil);<br/><br/>Â Â Â  ä»ç¼“å­˜ä¸­å–ï¼Œå¦‚æœæ²¡æœ‰æ‰å»è®¾ç½®<br/>Â Â Â  MJPropertyType *<span>type =</span> types_[code];<br/>Â Â Â  if (<span>type == nil) {</span><br/>Â Â Â Â Â Â Â  <span>type =</span> [[self alloc] init];<br/>Â Â Â Â Â Â Â  <span>type.code =</span> code;<br/>Â Â Â Â Â Â Â  å­˜å‚¨èµ·æ¥<br/>Â Â Â Â Â Â Â  types_[code] = <span>type;</span><br/>Â Â Â  }<br/>Â Â Â  return <span>type;</span><br/>}</font></code></pre><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">æ¥ä¸‹é‡Œçœ‹çœ‹ç±»å‹ç¼–ç çš„è½¬æ¢éƒ¨åˆ†ã€‚</span></div><pre><code><font color="#0433ff">å‚æ•°ç±»å‹è½¬æ¢<br/>- (void)setCode:(NSString *)code<br/>{<br/>Â Â Â  _code = code;<br/><br/>Â Â Â  MJExtensionAssertParamNotNil(code);<br/><br/>Â Â Â  if ([code isEqualToString:MJPropertyTypeId]) {<br/>Â Â Â Â Â Â Â  _idType = YES;<br/>Â Â Â  } else if (code.length == 0) {<br/>Â Â Â Â Â Â Â  _KVCDisabled = YES;<br/>Â Â Â  } else if (code.length &gt; 3 &amp;&amp; [code hasPrefix:@&quot;@\&quot;&quot;]) {<br/>Â Â Â Â Â Â Â  å»æ‰@&quot;å’Œ&quot;ï¼Œæˆªå–ä¸­é—´çš„ç±»å‹åç§°<br/>Â Â Â Â Â Â Â  _code = [code substringWithRange:NSMakeRange(2, code.length - 3)];<br/>Â Â Â Â Â Â Â  å¾—åˆ°ç±»å‹ç±»å‹<br/>Â Â Â Â Â Â Â  _typeClass = NSClassFromString(_code);<br/>Â Â Â Â Â Â Â  _fromFoundation = [MJFoundation isClassFromFoundation:_typeClass];<br/>Â Â Â Â Â Â Â  æ˜¯å¦ä¸ºNSNumberç±»å‹<br/>Â Â Â Â Â Â Â  _numberType = [_typeClass isSubclassOfClass:[NSNumber class]];<br/><br/>Â Â Â  } else if ([code isEqualToString:MJPropertyTypeSEL] ||<br/>Â Â Â Â Â Â Â Â Â Â Â Â Â Â  [code isEqualToString:MJPropertyTypeIvar] ||<br/>Â Â Â Â Â Â Â Â Â Â Â Â Â Â  [code isEqualToString:MJPropertyTypeMethod]) {<br/>Â Â Â Â Â Â Â  _KVCDisabled = YES;<br/>Â Â Â  }<br/><br/>Â Â Â  æ˜¯å¦ä¸ºæ•°å­—ç±»å‹<br/>Â Â Â  NSString *lowerCode = _code.lowercaseString;<br/>Â Â Â  NSArray *numberTypes = @[MJPropertyTypeInt, MJPropertyTypeShort, MJPropertyTypeBOOL1, MJPropertyTypeBOOL2, MJPropertyTypeFloat, MJPropertyTypeDouble, MJPropertyTypeLong, MJPropertyTypeLongLong, MJPropertyTypeChar];<br/><br/>Â Â Â  æ˜¯å¦ä¸ºåŸºæœ¬æ•°æ®ç±»å‹<br/>Â Â Â  if ([numberTypes containsObject:lowerCode]) {<br/>Â Â Â Â Â Â Â  _numberType = YES;<br/><br/>Â Â Â Â Â Â Â  if ([lowerCode isEqualToString:MJPropertyTypeBOOL1]<br/>Â Â Â Â Â Â Â Â Â Â Â  || [lowerCode isEqualToString:MJPropertyTypeBOOL2]) {<br/>Â Â Â Â Â Â Â Â Â Â Â  _boolType = YES;<br/>Â Â Â Â Â Â Â  }<br/>Â Â Â  }<br/>}</font></code></pre><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">æ¯”è¾ƒé‡è¦çš„æ˜¯è¿™ä¸€æ®µ</span></div><pre><code><font color="#0433ff"> if ([code isEqualToString:MJPropertyTypeId]) {<br/>Â Â Â Â Â Â Â  _idType = YES;<br/>Â Â Â  } else if (code.length == 0) {<br/>Â Â Â Â Â Â Â  _KVCDisabled = YES;<br/>Â Â Â  } else if (code.length &gt; 3 &amp;&amp; [code hasPrefix:@&quot;@\&quot;&quot;]) {<br/>Â Â Â Â Â Â Â  å»æ‰@&quot;å’Œ&quot;ï¼Œæˆªå–ä¸­é—´çš„ç±»å‹åç§°<br/>Â Â Â Â Â Â Â  _code = [code substringWithRange:NSMakeRange(2, code.length - 3)];<br/>Â Â Â Â Â Â Â  å¾—åˆ°ç±»å‹ç±»å‹<br/>Â Â Â Â Â Â Â  _typeClass = NSClassFromString(_code);<br/>Â Â Â Â Â Â Â  _fromFoundation = [MJFoundation isClassFromFoundation:_typeClass];<br/>Â Â Â Â Â Â Â  æ˜¯å¦ä¸ºNSNumberç±»å‹<br/>Â Â Â Â Â Â Â  _numberType = [_typeClass isSubclassOfClass:[NSNumber class]];<br/><br/>Â Â Â  } else if ([code isEqualToString:MJPropertyTypeSEL] ||<br/>Â Â Â Â Â Â Â Â Â Â Â Â Â Â  [code isEqualToString:MJPropertyTypeIvar] ||<br/>Â Â Â Â Â Â Â Â Â Â Â Â Â Â  [code isEqualToString:MJPropertyTypeMethod]) {<br/>Â Â Â Â Â Â Â  _KVCDisabled = YES;<br/>Â Â Â  }</font></code></pre><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">ä¼ è¿›æ¥çš„codeå°±æ˜¯å±æ€§æ‰€å¯¹åº”çš„å±æ€§åç§°ï¼Œæ¯”å¦‚NSArrayå¯¹åº”@&quot;NSArray&quot;ã€‚è‡ªå®šä¹‰çš„ç±»ï¼Œç­¾åéƒ½ä¼šæœ‰ä¸€ä¸ª@ç¬¦å·ï¼Œåé¢æ¥ä¸Šç±»åã€‚å½¢å¼å¦‚@Classnameã€‚</span></div><h2>MJPropertyKey.h</h2><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">è¿™ä¸ªç±»æ˜¯å¯¹å±æ€§è¿›è¡Œåˆ†ç±»ã€‚æ‰€æœ‰å±æ€§å¯ä»¥å½’ä¸ºä¸¤ç±»ä¸€ç§æ˜¯å­—å…¸ï¼Œä¹Ÿå°±æ˜¯é”®å€¼å¯¹ï¼ˆNSDictionaryï¼‰å’Œæ•°ç»„ï¼ˆNSArrayï¼‰ã€‚</span></div><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">å¤–é¢é€šè¿‡è°ƒç”¨- (id)valueInObject:(id)objectä»ä¼ è¿›æ¥çš„idç±»å‹ä¸­å–å€¼ã€‚</span></div><h2>MJProperty.h</h2><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">å¯¹objc_property_tå°è£…ï¼Œå­˜å‚¨ä¸€ä¸ªå±æ€§å€¼ç›¸å…³çš„è¯¦ç»†ä¿¡æ¯ï¼Œå°†objc_property_tè½¬ä¸ºèƒ½å¤Ÿç›´æ¥ç”¨çš„å¯¹è±¡ã€‚å®ƒæ˜¯å¯¹objc_property_tç±»å‹çš„ä¸€æ¬¡å°è£…ï¼Œä¾¿äºæˆ‘ä»¬ä½¿ç”¨ã€‚åŒäº‹å®ƒä¹Ÿä¾èµ–äºä¸Šé¢æ‰€ä»‹ç»çš„å‡ ç§æ•°æ®ç±»å‹ã€‚ä».hæ–‡ä»¶çœ‹åˆ°#import &quot;MJPropertyType.h&quot; #import &quot;MJPropertyKey.h&quot;ã€‚åŒæ ·ä¹Ÿä¾èµ–äº#import &quot;MJFoundation.h&quot; #import &quot;MJExtensionConst.h&quot;</span></div><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">åˆå§‹åŒ–å…¥å£å‡½æ•°+ (instancetype)cachedPropertyWithProperty:(objc_property_t)propertyã€‚æ­£å¦‚ä¸Šé¢æ‰€è¯´ç›®çš„å°±æ˜¯å°†runtimeä¸­çš„objc_property_tè½¬ä¸ºMJPropertyæ–¹ä¾¿æˆ‘ä»¬çš„ä½¿ç”¨ã€‚</span></div><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">å…·ä½“å®ç°ï¼š</span></div><pre><code><font color="#0433ff">+ (instancetype)cachedPropertyWithProperty:(objc_property_t)property<br/>{<br/>Â Â Â  MJProperty *propertyObj = objc_getAssociatedObject(self, property);<br/>Â Â Â  if (propertyObj == nil) {<br/>Â Â Â Â Â Â Â  propertyObj = [[self alloc] init];<br/>Â Â Â Â Â Â Â  è½¬ä¸ºMJProperty<br/>Â Â Â Â Â Â Â  propertyObj.property = property;<br/>Â Â Â Â Â Â Â  objc_setAssociatedObject(self, property, propertyObj, OBJC_ASSOCIATION_RETAIN_NONATOMIC);<br/>Â Â Â  }<br/>Â Â Â  return propertyObj;<br/>}</font></code></pre><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">MJProperty *propertyObj = objc_getAssociatedObject(self, property);è¿™å¥è¯æ˜¯åŠ¨æ€ç»™ç±»æ·»åŠ å±æ€§ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç»™ç±»æ·»åŠ äº†ä¸€ä¸ªå±æ€§åä¸ºpropertyçš„MJPropertyç±»å‹å±æ€§ã€‚</span><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em; font-weight: bold;">æ³¨æ„è¿™é‡Œæ˜¯ä¸€ä¸ªç±»æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯è¿™é‡Œçš„</span><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em; font-weight: bold;">self</span><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em; font-weight: bold;">ä»£è¡¨ä»€ä¹ˆã€‚</span></div><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">è¿™é‡Œçš„ç¼“å­˜æ–¹æ³•æ˜¯é€šè¿‡æ‡’åŠ è½½çš„å½¢å¼å®ç°çš„ï¼Œå°†éœ€è¦ç¼“å­˜çš„å±æ€§åŠ¨æ€æ·»åŠ åˆ°ç±»ä¸Šé¢ã€‚å¦‚æœæ²¡æœ‰åˆ™æ–°åŠ å±æ€§æœ‰åˆ™ç›´æ¥è¿”å›å±æ€§ã€‚è¿™æ ·åšçš„ç›®çš„æ˜¯ä¸ºäº†ä¸€ä¸ªç±»å¯èƒ½åœ¨é¡¹ç›®ä¸­ä¼šç”¨åˆ°å¾ˆå¤šæ¬¡å­—å…¸è½¬æ¨¡å‹ã€‚æ‰€ä»¥ä¿å­˜ä¸€ä»½ä¹‹åå°±ä¸ç”¨æ¯æ¬¡éƒ½åˆ›å»ºæ–°çš„å±æ€§æ ‡è¯†äº†ã€‚</span><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em; font-weight: bold;">ä»¥ç©ºé—´æ¢æ—¶é—´</span></div><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">æŠŠè¿™ä¸ªæ–¹æ³•æ‰§è¡Œå®Œï¼Œå°±å¾—åˆ°äº†å¦‚ä¸‹ä¸‰ä¸ªå±æ€§çš„å€¼ï¼š</span></div><pre><code><font color="#0433ff">/** æˆå‘˜å±æ€§ */<br/>@property (nonatomic, assign) objc_property_t property;<br/>/** æˆå‘˜å±æ€§çš„åå­— */<br/>@property (nonatomic, readonly) NSString *name;<br/><br/>/** æˆå‘˜å±æ€§çš„ç±»å‹ */<br/>@property (nonatomic, readonly) MJPropertyType *type;</font></code></pre><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em; color: rgb(4, 51, 255);">é™¤äº†å…¬å¼€çš„å±æ€§è¿˜æœ‰ä¸¤ä¸ªç§æœ‰å±æ€§ï¼š</span></div><pre><code><font color="#0433ff">@property (strong, nonatomic) NSMutableDictionary *propertyKeysDict;<br/>@property (strong, nonatomic) NSMutableDictionary *objectClassInArrayDict;</font></code></pre><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em; color: rgb(4, 51, 255);">ä»–ä»¬åˆ†åˆ«ä¿å­˜äº†çš„ç±»å‹æ˜¯</span><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em; color: rgb(4, 51, 255);">MJPropertyKey</span></div><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">é€šè¿‡</span></div><pre><code><font color="#0433ff">/**<br/> * è®¾ç½®objectçš„æˆå‘˜å˜é‡å€¼<br/> */<br/>- (void)<span>setValue:(id)value forObject:(id)object</span>;<br/>/**<br/> * å¾—åˆ°objectçš„æˆå‘˜å±æ€§å€¼<br/> */<br/>- (id)<span>valueForObject:(id)object</span>;</font></code></pre><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em; color: rgb(4, 51, 255);">å¯¹ç‰¹å®šçš„å±æ€§å­˜å–å€¼ã€‚</span></div><pre><code><font color="#0433ff">/** éæ•°ç»„ç±»å‹ */<br/>- (void)<span>setOriginKey:(id)originKey forClass:(Class)c</span>;<br/>- (NSArray *)<span>propertyKeysForClass:(Class)c</span>;<br/><br/>/** æ¨¡å‹æ•°ç»„ä¸­çš„ä¿å­˜æ¨¡å‹ç±»å‹ */<br/>- (void)<span>setObjectClassInArray:(Class)objectClass forClass:(Class)c</span>;<br/>- (Class)<span>objectClassInArrayForClass:(Class)c</span>;</font></code></pre><blockquote><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">è®°ï¼šæœ¬æ¥è¯¥ä¸Šä¸ªå‘¨å°±å®Œæˆçš„ã€‚æ‹–åˆ°äº†ç°åœ¨è¿˜æ²¡æœ‰åˆ†æå®Œã€‚</span></div></blockquote><h2>NSObject+MJClass.h</h2><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">ä»è¿™ä¸ªç±»å¼€å§‹ï¼Œå°±è¿›å…¥äº†åˆ†æNSObjectåˆ†ç±»çš„ç¨‹åº¦äº†ã€‚å‰é¢åˆ†æçš„å¯¹è±¡æ˜¯ä¸ºNSObjectæ‰€ä¾èµ–çš„ã€‚</span></div><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">è¿™ä¸ªç±»çš„åŠŸèƒ½å¤§è‡´å¯ä»¥å½’ä¸ºéå†ã€å±æ€§ç™½åå•ã€å±æ€§é»‘åå•ã€‚æ‰€ä»¥å¯ä»¥é‡ç‚¹æ¥çœ‹çœ‹è¿™ä¸‰ä¸ªéƒ¨åˆ†ã€‚</span></div><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">å¤–éƒ¨é€šè¿‡+ (NSMutableArray *)mj_totalIgnoredPropertyNames;å’Œ+ (NSMutableArray *)mj_totalAllowedCodingPropertyNames;è·å¾—é»‘åå•ä¸ç™½åå•ã€‚</span></div><h3>ç±»çš„éå†</h3><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">éå†å°±ä¸¤ä¸ªæ–¹æ³•ï¼š</span></div><pre><code><font color="#0433ff">+ (void)<span>mj_enumerateClasses:(MJClassesEnumeration)enumeration</span>;<br/>+ (void)<span>mj_enumerateAllClasses:(MJClassesEnumeration)enumeration</span>;</font></code></pre><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">mj_enumerateClassesåªè¦å½“å‰éå†çš„æ˜¯Foundatoinæ¡†æ¶çš„å°±ä¼šé€€å‡ºéå†ï¼Œå¦åˆ™ä¼šä¸€ç›´æ²¿ç€ç»§æ‰¿æ ‘éå†ã€‚mj_enumerateAllClassesä¼šéå†ç»§æ‰¿æ ‘ä¸Šæ‰€æœ‰çš„ç±»ã€‚</span><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em; font-weight: bold;">ä¸ºä»€ä¹ˆä¼šå­˜åœ¨éå†åˆ°</span><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em; font-weight: bold;">Foundatoin</span><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em; font-weight: bold;">æ¡†æ¶å°±åœæ­¢éå†äº†ï¼Œå› ä¸ºæˆ‘ä»¬è‡ªå®šä¹‰çš„æ¨¡å‹å¤§éƒ¨åˆ†æ˜¯ç»§æ‰¿è‡³NSObjectè¿™ä¸­ç±»å‹ã€‚è¿™æ˜¯ä¸ºä»€ä¹ˆåœæ­¢ï¼Œé‚£ä¸ºä»€ä¹ˆè¦éå†ã€‚å› ä¸ºè‡ªå®šä¹‰çš„æ¨¡å‹å¯èƒ½ç»§æ‰¿è‡ªå·±æˆ‘ä»¬è‡ªå®šä¹‰çš„æ¨¡å‹ã€‚ä¸ºäº†ä¿æŠ¤æ‰€æœ‰çš„ä¿¡æ¯ï¼Œæ¯”å¦‚å±æ€§ä¿¡æ¯ï¼Œæ‰€ä»¥éœ€è¦éå†ã€‚</span></div><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">æ³¨æ„è¿™é‡Œçš„å‚æ•°æ˜¯å…¶å®æ˜¯ä¸€ä¸ªtypedef void (^MJClassesEnumeration)(Class c, BOOL *stop);Blockã€‚å†™æ³•æœ‰ç‚¹ç±»ä¼¼ç³»ç»Ÿä¸­æ•°ç»„éå†ã€‚è¿™ç§å†™æ³•å€¼å¾—å­¦ä¹ ï¼Œå¹³æ—¶æˆ‘ä»¬éå†éƒ½æ˜¯åœ¨ç±»ä¸­ç›´æ¥è°ƒç”¨ä¸€ä¸ªæ–¹æ³•ï¼Œè€Œé€šè¿‡è¿™æ ·ä¼ é€’Blockè¿™æ ·å°±æ›´åŠ è§£è€¦äº†ã€‚å…¶å®ä¹Ÿå¯ä»¥é€šè¿‡Target-Actionæ¨¡å¼å®ç°ã€‚æ³¨æ„è¿™é‡Œçš„Boolç±»å‹ä¼ çš„æ˜¯æŒ‡é’ˆå“¦ï¼Œå°±åƒ*stopã€‚</span></div><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">ç›¸å…³çš„å®ç°ï¼š</span></div><pre><code><font color="#0433ff">+ (void)mj_enumerateClasses:(MJClassesEnumeration)enumeration<br/>{<br/>Â Â Â   1.æ²¡æœ‰blockå°±ç›´æ¥è¿”å›<br/>Â Â Â  if (enumeration == nil) return;<br/><br/>Â Â Â   2.åœæ­¢éå†çš„æ ‡è®°<br/>Â Â Â  BOOL stop = NO;<br/><br/>Â Â Â   3.å½“å‰æ­£åœ¨éå†çš„ç±»<br/>Â Â Â  Class c = self;<br/><br/>Â Â Â   4.å¼€å§‹éå†æ¯ä¸€ä¸ªç±»<br/>Â Â Â  while (c &amp;&amp; !stop) {<br/>Â Â Â Â Â Â Â   4.1.æ‰§è¡Œæ“ä½œ<br/>Â Â Â Â Â Â Â   å¯¹ä¸€èˆ¬ç±»å‹å–åœ°å€ä¼ é€’<br/>Â Â Â Â Â Â Â  enumeration(c, &amp;stop);<br/><br/>Â Â Â Â Â Â Â   4.2.è·å¾—çˆ¶ç±»<br/>Â Â Â Â Â Â Â  c = class_getSuperclass(c);<br/><br/>Â Â Â Â Â Â Â  if ([MJFoundation isClassFromFoundation:c]) break;<br/>Â Â Â  }<br/>}</font></code></pre><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">é‡ç‚¹çœ‹çœ‹è¿™å¥</span></div><pre><code> <font color="#0433ff"> 4.1.æ‰§è¡Œæ“ä½œ<br/>Â Â Â Â Â Â Â  å¯¹ä¸€èˆ¬ç±»å‹å–åœ°å€ä¼ é€’<br/>Â Â Â Â Â Â Â  enumeration(c, &amp;stop);</font></code></pre><h3>ç™½åå•é…ç½®</h3><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">é…ç½®ç™½åå•æ˜¯ä¸ºäº†å¯¹å±æ€§è¿›è¡Œè¿‡æ»¤ã€‚åªæœ‰åœ¨ç™½åå•ä¸­çš„å±æ€§åæ‰ä¼šè¿›è¡Œå­—å…¸å’Œæ¨¡å‹çš„è½¬æ¢ã€‚æ¥è¯´ä¸€ä¸‹è¿™é‡Œæ¶‰åŠçš„é…ç½®æ–¹æ³•ã€‚</span></div><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">å¤–éƒ¨è°ƒç”¨è€…ï¼Œé€šè¿‡ç±»æ–¹æ³•ä¼ å…¥Blockå‚æ•°è¿›è¡Œé…ç½®ã€‚typedef NSArray * (^MJAllowedPropertyNames)();è¿™æ˜¯ä¼ å…¥çš„Blockå®šä¹‰ã€‚å¯ä»¥çœ‹åˆ°è¿”å›çš„æ˜¯ä¸€ä¸ªæ•°ç»„ã€‚ä¸ºä»€ä¹ˆä¸ç›´æ¥å°†ç™½åå•å±æ€§æš´éœ²å¤„ç†å‡ºæ¥ç»™è°ƒç”¨è€…ç›´æ¥ä½¿ç”¨å‘¢ï¼Ÿå¤§æ¦‚æ˜¯éµå¾ªäº†è®¾è®¡æ¨¡å¼ä¸­çš„çŸ¥é“æœ€å°‘åŸåˆ™ã€‚</span></div><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">åœ¨.mæ–‡ä»¶ä¸­å®šä¹‰äº†å‡ ä¸ªä¿å­˜ç™½åå•ã€é»‘åå•çš„é™æ€æ•°ç»„ã€‚å®šä¹‰å¦‚ä¸‹ï¼š</span></div><pre><code><font color="#0433ff">static NSMutableDictionary *allowedPropertyNamesDict_;<br/>static NSMutableDictionary *ignoredPropertyNamesDict_;<br/>static NSMutableDictionary *allowedCodingPropertyNamesDict_;<br/>static NSMutableDictionary *ignoredCodingPropertyNamesDict_;</font></code></pre><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">ä¸ºäº†ä¿å­˜ä¼ å…¥çš„Blockä¿¡æ¯ï¼Œéœ€è¦ç»™åˆ†ç±»åŠ¨æ€æ·»åŠ å±æ€§ã€‚</span></div><pre><code><font color="#0433ff">åœ¨åˆ†ç±»ä¸­æ–°å¢å±æ€§<br/>static const char MJAllowedPropertyNamesKey = '\0'; ç™½åå•<br/>static const char MJIgnoredPropertyNamesKey = '\0'; é»‘åå•<br/>static const char MJAllowedCodingPropertyNamesKey = '\0'; å½’æ¡£ç™½åå•<br/>static const char MJIgnoredCodingPropertyNamesKey = '\0'; å½’æ¡£é»‘åå•</font></code></pre><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">æ¯”å¦‚è¿™é‡Œçš„MJAllowedPropertyNamesKeyå°±æ˜¯ç™½åå•ä¼ è¿›æ¥çš„å±æ€§åç§°äº†ã€‚</span></div><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">è®¾ç½®ç™½åå•çš„å…¥å£ï¼š</span></div><pre><code><font color="#0433ff">+ (void)mj_setupAllowedPropertyNames:(MJAllowedPropertyNames)allowedPropertyNames;<br/>{<br/>Â Â Â  [self mj_setupBlockReturnValue:allowedPropertyNames key:&amp;MJAllowedPropertyNamesKey];<br/>}</font></code></pre><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">æœ€ç»ˆè°ƒç”¨çš„æ˜¯mj_setupBlockReturnValue</span></div><pre><code><font color="#0433ff">+ (void)mj_setupBlockReturnValue:(id (^)())block key:(const char *)key<br/>{<br/>Â Â Â  if (block) {<br/>Â Â Â Â Â Â Â  objc_setAssociatedObject(self, key, block(), OBJC_ASSOCIATION_RETAIN_NONATOMIC);<br/>Â Â Â  } else {<br/>Â Â Â Â Â Â Â  objc_setAssociatedObject(self, key, nil, OBJC_ASSOCIATION_RETAIN_NONATOMIC);<br/>Â Â Â  }<br/><br/>Â Â Â  æ¸…ç©ºæ•°æ®<br/>Â Â Â  [[self dictForKey:key] removeAllObjects];<br/>}</font></code></pre><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">å¯ä»¥å¾ˆæ¸…æ¥šçš„çœ‹åˆ°è¿™é‡Œå°†blockä½œä¸ºè‡ªèº«çš„å±æ€§ã€‚</span></div><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em; font-weight: bold;">é™¤äº†è¿™ç§æ–¹å¼è¿˜æœ‰ä¸€ç§ï¼š</span><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">é‚£å°±æ˜¯åœ¨ç±»ä¸­å®ç°mj_allowedPropertyNamesæ¯”å¦‚ï¼š</span></div><pre><code><font color="#0433ff">+ (NSArray *)mj_allowedPropertyNames {<br/>Â Â Â  return @[@&quot;name&quot;,@&quot;icon&quot;];<br/>}</font></code></pre><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">åé¢è·å–å¯ç”¨å±æ€§çš„æ—¶å€™ä¼šå¯¹è¿™ä¸¤ç§æ–¹å¼éƒ½åˆ¤æ–­ã€‚</span></div><h3>è®¾ç½®é»‘åå•</h3><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">è®¾ç½®é»‘åå•çš„æ–¹å¼å’Œè®¾ç½®ç™½åå•ç±»ä¼¼ã€‚</span></div><h3>æœ€ç»ˆå¯è½¬æ¢çš„æ•°ç»„</h3><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">è°ƒç”¨è¿™ä¸ªæ–¹æ³•mj_totalIgnoredPropertyNameså°±æ˜¯è¿”å›ç»è¿‡è¿‡æ»¤åçš„å±æ€§ã€‚</span></div><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">ä¸€å…±æœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯é€šè¿‡Selecoträ¸€ç§æ˜¯é€šè¿‡Blockè®¾ç½®ã€‚</span></div><pre><code><font color="#0433ff">+ (NSMutableArray *)mj_totalObjectsWithSelector:(SEL)selector key:(const char *)key<br/>{<br/>Â Â Â  NSMutableArray *array = [self dictForKey:key][NSStringFromClass(self)];<br/>Â Â Â  if (array) return array;<br/><br/>Â Â Â  åˆ›å»ºã€å­˜å‚¨<br/>Â Â Â  [self dictForKey:key][NSStringFromClass(self)] = array = [NSMutableArray array];<br/><br/>Â Â Â  if ([self respondsToSelector:selector]) {<br/>#pragma clang diagnostic push<br/><span>#pragma clang diagnostic ignored &quot;-Warc-performSelector-leaks&quot;</span><br/>Â Â Â Â Â Â Â  NSArray *subArray = [self performSelector:selector];<br/>#pragma clang diagnostic pop<br/>Â Â Â Â Â Â Â  if (subArray) {<br/>Â Â Â Â Â Â Â Â Â Â Â  [array addObjectsFromArray:subArray];<br/>Â Â Â Â Â Â Â  }<br/>Â Â Â  }<br/><br/>Â Â Â  [self mj_enumerateAllClasses:^(__unsafe_unretained Class c, BOOL *stop) {<br/>Â Â Â Â Â Â Â  NSArray *subArray = objc_getAssociatedObject(c, key);<br/>Â Â Â Â Â Â Â  [array addObjectsFromArray:subArray];<br/>Â Â Â  }];<br/>Â Â Â  return array;<br/>}</font></code></pre><h4>é€šè¿‡Selector</h4><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">selectoræ˜¯ä½¿ç”¨è€…å¦‚æœæƒ³æ·»åŠ ç™½åå•éœ€è¦è‡ªå®šä¹‰å®ç°ç±»æ–¹æ³•mj_allowedPropertyNamesã€‚è¿”å›çš„æ˜¯ä¸€ä¸ªç™½åå•æ•°ç»„ã€‚é»‘åå•åŸç†ç±»ä¼¼ã€‚keyæ˜¯æŒ‡å®šè¿‡æ»¤çš„æ˜¯ç™½åå•è¿˜æ˜¯é»‘åå•ã€‚</span></div><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">selectorçš„æ–¹å¼éœ€è¦ç»™å¯¹åº”çš„ç±»æ·»åŠ ä¸€ä¸ªç±»æ–¹æ³•å¦‚ï¼š</span></div><pre><code><font color="#0433ff">+ (NSArray *)mj_allowedPropertyNames {<br/>Â Â Â  return @[@&quot;name&quot;,@&quot;icon&quot;];<br/>}</font></code></pre><h4>é€šè¿‡Block</h4><blockquote><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">ç–‘æƒ‘ï¼šå‰é¢è®¾ç½®çš„æ˜¯ä¸€ä¸ªè¿”å›å€¼ç±»å‹ä¸ºæ•°ç»„çš„Blockã€‚ä»£ç ï¼š</span></div><pre><code>Â  <font color="#0433ff">if (block) {<br/>Â Â Â Â Â Â Â  objc_setAssociatedObject(self, key, block(), OBJC_ASSOCIATION_RETAIN_NONATOMIC);<br/>Â Â Â  } else {<br/>Â Â Â Â Â Â Â  objc_setAssociatedObject(self, key, nil, OBJC_ASSOCIATION_RETAIN_NONATOMIC);<br/>Â Â Â  }</font></code></pre></blockquote><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">ä½†æ˜¯å–å¾—æ—¶å€™åˆæ˜¯ç›´æ¥å–å¾—æ•°ç»„ã€‚éš¾é“è¿™ä¸ªæ—¶å€™blockä¼šè‡ªåŠ¨æ‰§è¡Œï¼Œç„¶åè¿”å›æ‰§è¡Œç»“æœ</span></div><blockquote><pre><code>Â  <span><font color="#0433ff">[self mj_enumerateAllClasses:^<span>(__unsafe_unretained Class c, BOOL *stop)</span> {<br/>Â Â Â Â Â Â Â  NSArray *subArray = objc_getAssociatedObject<span>(c, key)</span>;<br/>Â Â Â Â Â Â Â  <span>[array addObjectsFromArray:subArray];<br/>Â Â Â  }];</span></font></span></code></pre></blockquote><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em; font-weight: bold;">æœ€åé€šè¿‡å®è·µè¯æ˜ï¼Œç¡®å®èƒ½å¤Ÿä»</span><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em; font-weight: bold;">objc_getAssociatedObject(c, key);</span><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em; font-weight: bold;">å¾—åˆ°å¯¹åº”çš„æ•°ç»„ã€‚ä¹Ÿå°±æ˜¯ä½œä¸ºå±æ€§çš„</span><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em; font-weight: bold;">block</span><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em; font-weight: bold;">æ‰§è¡Œäº†ã€‚</span></div><h2>NSObject+MJCoding.h</h2><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">è¿™ä¸ªç±»æ˜¯ç”¨äºå½’æ¡£ã€‚åªæœ‰å®ç°äº†MJCodingåè®®çš„ç±»æ‰èƒ½å¤Ÿå½’æ¡£ã€‚</span></div><pre><code><font color="#0433ff">/**<br/> *Â  è¿™ä¸ªæ•°ç»„ä¸­çš„å±æ€§åæ‰ä¼šè¿›è¡Œå½’æ¡£<br/> */<br/>+ (NSArray *)mj_allowedCodingPropertyNames;<br/>/**<br/> *Â  è¿™ä¸ªæ•°ç»„ä¸­çš„å±æ€§åå°†ä¼šè¢«å¿½ç•¥ï¼šä¸è¿›è¡Œå½’æ¡£<br/> */<br/>+ (NSArray *)mj_ignoredCodingPropertyNames;</font></code></pre><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">åœ¨è¿›è¡Œå½’æ¡£çš„æ—¶å€™ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨Implemenionä¸­æ·»åŠ MJExtensionCodingImplementationã€‚</span></div><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">å®é™…ä¸Šæ˜¯å®å®šä¹‰äº†NSCodeè¿›è¡Œå½’æ¡£ï¼Œè§£æ¡£ã€‚</span></div><pre><code><font color="#0433ff">#define MJCodingImplementation \<br/>- (id)initWithCoder:(NSCoder *)decoder \<br/>{ \<br/>if (self = [super init]) { \<br/>[self mj_decode:decoder]; \<br/>} \<br/>return self; \<br/>} \<br/>\<br/>- (void)encodeWithCoder:(NSCoder *)encoder \<br/>{ \<br/>[self mj_encode:encoder]; \<br/>}</font></code></pre><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em; color: rgb(4, 51, 255);">çœ‹ä¸€çœ‹å½’æ¡£çš„éƒ¨åˆ†ï¼Œè§£æ¡£çš„æ­¥éª¤ä¸€æ ·ã€‚</span></div><pre><code><font color="#0433ff">- (void)mj_encode:(NSCoder *)encoder<br/>{<br/>Â Â Â  Class clazz = [self class];<br/><br/>Â Â Â  NSArray *allowedCodingPropertyNames = [clazz mj_totalAllowedCodingPropertyNames];<br/>Â Â Â  NSArray *ignoredCodingPropertyNames = [clazz mj_totalIgnoredCodingPropertyNames];<br/><br/>Â Â Â  [clazz mj_enumerateProperties:^(MJProperty *property, BOOL *stop) {<br/>Â Â Â Â Â Â Â  æ£€æµ‹æ˜¯å¦è¢«å¿½ç•¥<br/>Â Â Â Â Â Â Â  if (allowedCodingPropertyNames.count &amp;&amp; ![allowedCodingPropertyNames containsObject:property.name]) return;<br/>Â Â Â Â Â Â Â  if ([ignoredCodingPropertyNames containsObject:property.name]) return;<br/><br/>Â Â Â Â Â Â Â  id value = [property valueForObject:self];<br/>Â Â Â Â Â Â Â  if (value == nil) return;<br/>Â Â Â Â Â Â Â  [encoder encodeObject:value forKey:property.name];<br/>Â Â Â  }];<br/>}</font></code></pre><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">ç›´æ¥çœ‹é‡ç‚¹ï¼š</span></div><pre><code>Â <font color="#0433ff"> id value = [property valueForObject:self];<br/>Â  if (value == nil) return;<br/>Â  [encoder encodeObject:value forKey:property.name];</font></code></pre><h2>NSObject+MJProperty.h</h2><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">è¿™ä¸ªç±»ä¿å­˜çš„å±æ€§çš„ä¸€äº›é…ç½®ã€‚å¤§è‡´å¯åˆ†ä¸ºï¼š</span></div><ul><li>1.éå†å±æ€§</li><li>2.æ–°å€¼é…ç½®</li><li>3.keyé…ç½®</li><li>4.array model classé…ç½®</li></ul><h3>éå†å±æ€§</h3><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">+ (void)mj_enumerateProperties:(MJPropertiesEnumeration)enumerationéå†æ‰€æœ‰å±æ€§çš„å…¥å£ã€‚è¿™ä¸ªæ–¹æ³•åœ¨å¾ˆå¤šåœ°æ–¹éƒ½å­˜åœ¨è¿‡ã€‚</span></div><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">å±æ€§ä¼šä»ç¼“å­˜ä¸­å–ï¼ŒNSArray *cachedProperties = [self properties];ã€‚[self properties]æ˜¯ç¼“å­˜å±æ€§çš„éƒ¨åˆ†ã€‚ç„¶åå°±ç›´æ¥éå†æ‰€æœ‰çš„å±æ€§ã€‚</span></div><pre><code><font color="#0433ff">+ (void)mj_enumerateProperties:(MJPropertiesEnumeration)enumeration<br/>{<br/>Â Â Â  è·å¾—æˆå‘˜å˜é‡<br/>Â Â Â  ä»ç±»çš„ç»§æ‰¿æ ‘éå†æ¯ä¸€ä¸ªç±»ï¼Œä»ç±»ä¸­è·å¾—å±æ€§<br/>Â Â Â  NSArray *cachedProperties = [self properties];<br/><br/>Â Â Â  éå†æˆå‘˜å˜é‡<br/>Â Â Â  BOOL stop = NO;<br/>Â Â Â  for (MJProperty *property in cachedProperties) {<br/>Â Â Â Â Â Â Â  enumeration(property, &amp;stop);<br/>Â Â Â Â Â Â Â  if (stop) break;<br/>Â Â Â  }<br/>}</font></code></pre><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">è¿™é‡Œéå†ç”¨äº†block,å¤–éƒ¨ä¼ é€’blockè¿›æ¥éå†ã€‚typedef void (^MJPropertiesEnumeration)(MJProperty *property, BOOL *stop);è¿™ä¸ªåº“å¾ˆå¤šåœ°æ–¹éƒ½ç”¨åˆ°äº†ç±»ä¼¼çš„éå†æ–¹å¼ã€‚</span></div><h3>æ–°å€¼é…ç½®</h3><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">æ–°å€¼é…ç½®æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿï¼šå°±æ˜¯æ”¹å˜ç‰¹å®šçš„å±æ€§çš„åŸæœ‰å€¼ï¼Œè¿™æ ·æ›´åŠ çµæ´»ã€‚</span></div><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">åŒæ ·æœ‰ä¸¤ç§æ–¹å¼Blockå’Œç±»æ–¹æ³•ã€‚</span></div><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">å­˜å–æ–¹æ³•å¦‚ä¸‹ï¼š</span></div><pre><code><font color="#0433ff">+ (void)<span>mj_setupNewValueFromOldValue:(MJNewValueFromOldValue)newValueFormOldValue</span>;<br/>+ (id)<span>mj_getNewValueFromObject:(__unsafe_unretained id)object oldValue:(__unsafe_unretained id)oldValue property:(__unsafe_unretained MJProperty *)property</span>;</font></code></pre><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">è¿™é‡Œçš„typedef id (^MJNewValueFromOldValue)(id object, id oldValue, MJProperty *property);å…¶å®å’Œä¸‹é¢æ–¹æ³•å‚æ•°å½¢å¼æ˜¯ä¸€æ ·çš„ã€‚</span></div><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">çœ‹äº†ä¸€ä¸‹è¿™ä¸ªæ–¹æ³•ï¼Œä¸€æ¬¡åªæ”¯æŒä¸€ä¸ªå±æ€§æ–°å€¼é…ç½®ã€‚</span></div><pre><code><font color="#0433ff">+ (void)<span>mj_setupNewValueFromOldValue:<span>(MJNewValueFromOldValue)newValueFormOldValue<br/>{<br/>Â Â Â  objc_setAssociatedObject(self, &amp;MJNewValueFromOldValueKey, newValueFormOldValue, OBJC_ASSOCIATION_COPY_NONATOMIC)</span></span>;<br/>}</font></code></pre><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">å¦‚ä½•è·å–æ–°ï¼Ÿè‚¯å®šéœ€è¦å…¼å®¹ä¸¤ç§è®¾ç½®æ–¹å¼ï¼Œä¸€ç§Block,ä¸€ç§é€šè¿‡æ–¹æ³•è®¾ç½®ã€‚</span></div><pre><code><font color="#0433ff">+ (id)mj_getNewValueFromObject:(__unsafe_unretained id)object oldValue:(__unsafe_unretained id)oldValue property:(MJProperty *__unsafe_unretained)property{<br/>Â Â Â  å¦‚æœæœ‰å®ç°æ–¹æ³•<br/>Â Â Â  if ([object respondsToSelector:@selector(mj_newValueFromOldValue:property:)]) {<br/>Â Â Â Â Â Â Â  return [object mj_newValueFromOldValue:oldValue property:property];<br/>Â Â Â  }<br/>Â Â Â  å…¼å®¹æ—§ç‰ˆæœ¬<br/>Â Â Â  if ([self respondsToSelector:@selector(newValueFromOldValue:property:)]) {<br/>Â Â Â Â Â Â Â  return [self performSelector:@selector(newValueFromOldValue:property:)Â  withObject:oldValueÂ  withObject:property];<br/>Â Â Â  }</font><br/><br/>Â Â Â <font color="#0433ff"> æŸ¥çœ‹é™æ€è®¾ç½®<br/>Â Â Â  __block id newValue = oldValue;<br/>Â Â Â  [self mj_enumerateAllClasses:^(__unsafe_unretained Class c, BOOL *stop) {<br/>Â Â Â Â Â Â Â  MJNewValueFromOldValue block = objc_getAssociatedObject(c, &amp;MJNewValueFromOldValueKey);<br/>Â Â Â Â Â Â Â  if (block) {<br/>Â Â Â Â Â Â Â Â Â Â Â  newValue = block(object, oldValue, property);<br/>Â Â Â Â Â Â Â Â Â Â Â  *stop = YES;<br/>Â Â Â Â Â Â Â  }<br/>Â Â Â  }];<br/>Â Â Â  return newValue;<br/>}</font></code></pre><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">æ€è·¯å’Œä¸Šé¢åˆ†æç™½åå•ï¼Œé»‘åå•è®¾ç½®çš„æ–¹å¼ä¸€æ ·ã€‚</span></div><h3>keyé…ç½®</h3><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">keyé…ç½®æ˜¯è§£å†³å±æ€§åæˆéœ€è¦é‡æ–°å®šä¹‰çš„æƒ…å†µã€‚</span></div><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">è¿™ä¸ªé…ç½®ç»Ÿä¸€é€šè¿‡Blockè®¾ç½®ã€‚</span></div><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">è¿™é‡Œæ³¨æ„åˆ°ä¸ºä»€ä¹ˆåœ¨åŠ¨æ€æ·»åŠ äº†å±æ€§ä¹‹åéœ€è¦å°†cachedPropertiesDict_å­—å…¸é‡Œé¢çš„æ¸…ç©ºä¸€æ¬¡ã€‚å¦‚ä¸‹ï¼š</span></div><pre><code><font color="#0433ff">+ (void)mj_setupReplacedKeyFromPropertyName:(MJReplacedKeyFromPropertyName)replacedKeyFromPropertyName<br/>{<br/>Â Â Â  [self mj_setupBlockReturnValue:replacedKeyFromPropertyName key:&amp;MJReplacedKeyFromPropertyNameKey];<br/><br/>Â Â Â  [[self dictForKey:&amp;MJCachedPropertiesKey] removeAllObjects];<br/>}<br/><br/>+ (void)mj_setupReplacedKeyFromPropertyName121:(MJReplacedKeyFromPropertyName121)replacedKeyFromPropertyName121<br/>{<br/>Â Â Â  objc_setAssociatedObject(self, &amp;MJReplacedKeyFromPropertyName121Key, replacedKeyFromPropertyName121, OBJC_ASSOCIATION_COPY_NONATOMIC);<br/><br/>Â Â Â  [[self dictForKey:&amp;MJCachedPropertiesKey] removeAllObjects];<br/>}</font></code></pre><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">è¿™æ ·åšçš„ç›®çš„æ˜¯ä¸ºäº†ä¿è¯ç¼“å­˜æ•°ç»„ä¸­çš„æ•°æ®æ˜¯æœ€æ–°çš„ã€‚å› ä¸ºæˆ‘ä»¬æ›¿æ¢äº†å±æ€§çš„keyï¼Œæ‰€ä»¥è¦ç”¨æœ€æ–°çš„ã€‚åœ¨è·å–æ‰€æœ‰å±æ€§ä¸­ã€‚æœ‰è¿™ä¹ˆä¸€æ®µï¼š</span></div><pre><code><font color="#0433ff"> NSMutableArray *cachedProperties = [self dictForKey:&amp;MJCachedPropertiesKey][NSStringFromClass(self)];<br/><br/>Â Â Â  if (cachedProperties == nil) {<br/>Â Â Â Â Â Â Â  cachedProperties = [NSMutableArray array];<br/>Â Â Â Â Â Â Â Â  éå†ç±»ç»§æ‰¿æ ‘ï¼Œä¸€ç›´éå†åˆ°fondationæ¡†æ¶ã€‚ä¹Ÿå°±æ˜¯åˆ°NSObjectå°±åœæ­¢éå†ã€‚å› ä¸ºæˆ‘ä»¬æ¨¡å‹éƒ½æ˜¯ä»NSObjectå¼€å§‹ç»§æ‰¿çš„<br/>Â Â Â Â Â Â Â  [self mj_enumerateClasses:^(__unsafe_unretained Class c, BOOL *stop) {<br/>Â Â Â Â Â Â Â Â Â 1.è·å¾—æ‰€æœ‰çš„æˆå‘˜å˜é‡<br/><br/>Â Â Â Â Â Â Â  ......<br/>}</font></code></pre><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">å¯ä»¥çœ‹åˆ°åªæœ‰å±æ€§ä¸ºç©ºæ‰ä¼šéå†ç±»ï¼Œè·å–æœ€æ–°å±æ€§ã€‚</span></div><h3>array model classé…ç½®</h3><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">è¿™ä¸ªæ–¹æ³•æ˜¯å¤„ç†æ¨¡å‹ä¸­åŒ…å«ä¸€å¦ä¸€ä¸ªæ¨¡å‹æ•°ç»„ã€‚</span><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em; font-weight: bold;">åœ¨å®é™…è¿ç”¨æ¯”è¾ƒå¤šã€‚</span></div><pre><code><font color="#0433ff">+ (void)<span>mj_setupObjectClassInArray:(MJObjectClassInArray)objectClassInArray<br/>{<br/>Â Â Â  [self mj_setupBlockReturnValue:objectClassInArray key:&amp;MJObjectClassInArrayKey]</span>;<br/><br/>Â Â Â  [[self dictForKey:&amp;MJCachedPropertiesKey] removeAllObjects];<br/>}</font></code></pre><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">å’Œä¸Šé¢çš„æ–¹å¼ä¸€æ ·ï¼Œä¼šå°†æœ€ç»ˆä¼šä½œä¸ºç±»çš„ä¸€ä¸ªå±æ€§å°†æ¨¡å‹æ•°ç»„å­—å…¸ä¿å­˜ä¸‹æ¥ã€‚æ–¹ä¾¿åé¢ä½¿ç”¨ã€‚</span></div><pre><code><font color="#0433ff">static const char MJReplacedKeyFromPropertyNameKey = '\0';<br/>static const char MJReplacedKeyFromPropertyName121Key = '\0';<br/>static const char MJNewValueFromOldValueKey = '\0';<br/>static const char MJObjectClassInArrayKey = '\0';<br/><br/>static const char MJCachedPropertiesKey = '\0';</font></code></pre><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">è¿™æ˜¯NSObject+MJProperty.håŠ¨æ€æ·»åŠ çš„æ‰€æœ‰å±æ€§ã€‚é€šè¿‡åå­—å¯ä»¥çŸ¥é“å®ƒçš„ç”¨é€”ã€‚</span></div><h2>NSObject+MJKeyValue.h</h2><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em; font-weight: bold;">è¿™ä¸ªç±»çš„å†…å®¹æœ‰ç‚¹å¤š</span></div><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">è¿™ä¸ªç±»ä¸­æœ‰ä¸€ä¸ªå¾ˆé‡è¦çš„åè®®MJKeyValueã€‚</span></div><pre><code><font color="#0433ff">+ <span>(NSArray *)mj_allowedPropertyNames;<br/>+ (NSArray *)</span>mj_ignoredPropertyNames;<br/>+ <span>(NSDictionary *)mj_replacedKeyFromPropertyName;<br/>+ (id)mj_replacedKeyFromPropertyName121:(NSString *)</span>propertyName;<br/>+ <span>(NSDictionary *)mj_objectClassInArray;<br/>- (id)mj_newValueFromOldValue:(id)oldValue property:(MJProperty *)</span>property;<br/>- <span>(void)</span>mj_keyValuesDidFinishConvertingToObject;<br/>- <span>(void)</span>mj_objectDidFinishConvertingToKeyValues;</font></code></pre><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">è¿™é‡Œçš„åè®®è§„å®šäº†ç™½åå•ã€é»‘åå•ã€‚ä¹‹å‰åˆ†æè¿‡é€šè¿‡blockçš„å½¢å¼åŒæ ·èƒ½å¤Ÿå®ç°é»‘ã€ç™½åå•ã€‚æˆ‘çŒœæµ‹è¿™ä¸ªæ–‡ä»¶æ˜¯å¾ˆä¹…ä¹‹å‰å°±æœ‰äº†ä¸ºäº†å…¼å®¹æ€§ï¼Œæ‰€ä»¥è¿™ç§è®¾ç½®ç™½ã€é»‘åå•çš„æ–¹å¼ä¸€è‡´ä¿ç•™ç€ã€‚</span></div><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em; font-weight: bold;">è¿™ä¹Ÿæ˜¯æˆ‘ä»¬åˆ†æçš„æœ€åä¸€ä¸ªç±»ï¼Œå¯èƒ½ä¹Ÿæ˜¯æœ€å¤æ‚çš„ä¸€ä¸ªç±»</span></div><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">åˆ†åˆ«æ˜¯ï¼š</span></div><ul><li>ç±»æ–¹æ³•</li><ul><li>é”™è¯¯å®šä¹‰</li><li>è½¬æ¢å­—å…¸replaceè®¾ç½®</li><li>æ¨¡å‹è½¬å­—å…¸</li><ul><li>è½¬æ‰€æœ‰å±æ€§</li><li>åˆ¶å®šéƒ¨åˆ†å±æ€§è½¬</li><li>å¿½ç•¥éƒ¨åˆ†å±æ€§è½¬</li><li>æ¨¡å‹æ•°ç»„è½¬å­—å…¸æ•°ç»„</li></ul><li>å­—å…¸è½¬æ¨¡å‹</li><ul><li>å­—å…¸è½¬ä¸ºæ¨¡å‹ï¼ˆå¯ä»¥æ˜¯NSDictionaryã€NSDataã€NSStringï¼‰</li><li>å­—å…¸è½¬ä¸ºæ¨¡å‹ï¼ˆå¯ä»¥æ˜¯NSDictionaryã€NSDataã€NSStringï¼‰<span style="font-weight: bold;">CoreDataæ”¯æŒ</span></li></ul><li>å­—å…¸æ•°ç»„è½¬æ¨¡å‹æ•°ç»„</li><ul><li>å­—å…¸æ•°ç»„æ¥åˆ›å»ºä¸€ä¸ªæ¨¡å‹æ•°ç»„ï¼ˆå¯ä»¥æ˜¯NSDictionaryã€NSDataã€NSStringï¼‰</li><li>å­—å…¸æ•°ç»„æ¥åˆ›å»ºä¸€ä¸ªæ¨¡å‹æ•°ç»„ï¼ˆå¯ä»¥æ˜¯NSDictionaryã€NSDataã€NSStringï¼‰<span style="font-weight: bold;">CoreDataæ”¯æŒ</span></li><li>plistæ¥åˆ›å»ºä¸€ä¸ªæ¨¡å‹æ•°ç»„</li><ul><li>ä»…é™äºmainBundleä¸­çš„æ–‡ä»¶</li><li>æ–‡ä»¶å…¨è·¯å¾„</li></ul></ul><li>æ¨¡å‹è½¬jsonã€å­—å…¸ã€æ•°ç»„</li><ul><li>è½¬æ¢ä¸ºJSON Data</li><li>è½¬æ¢ä¸ºå­—å…¸æˆ–è€…æ•°ç»„</li><li>è½¬æ¢ä¸ºJSON å­—ç¬¦ä¸²</li></ul></ul><li>å¯¹è±¡æ–¹æ³•</li><ul><li>å­—å…¸è½¬æ¨¡å‹</li><ul><li>å­—å…¸è½¬ä¸ºæ¨¡å‹ï¼ˆå¯ä»¥æ˜¯NSDictionaryã€NSDataã€NSStringï¼‰</li><li>å­—å…¸è½¬ä¸ºæ¨¡å‹ï¼ˆå¯ä»¥æ˜¯NSDictionaryã€NSDataã€NSStringï¼‰<span style="font-weight: bold;">CoreDataæ”¯æŒ</span></li></ul></ul></ul><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">ä¸Šé¢æ‰€åˆ—çš„å†…å®¹å°±æ˜¯è¿™ä¸ªæ¡†æ¶æä¾›ç»™ä½¿ç”¨è€…çš„æ‰€æœ‰åŠŸèƒ½äº†ã€‚è¿™ä¸ªéƒ¨åˆ†å°±æ˜¯æŠŠä¹‹å‰åˆ†æçš„å†…å®¹ä¸²åœ¨ä¸€èµ·ã€‚å®ç°è¿™äº›åŠŸèƒ½ã€‚</span></div><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">æˆ‘ä»¬ä»æœ€å¸¸ç”¨çš„+ (instancetype)mj_objectWithKeyValues:(id)keyValues;æ–¹æ³•å…¥æ‰‹ã€‚ä»å¤´åˆ°å°¾èµ°ä¸€éè¿™ä¸ªæµç¨‹ã€‚</span></div><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">ç›´æ¥çœ‹æœ€æ ¸å¿ƒéƒ¨åˆ†ã€‚å…¥å£å°±æ˜¯- (instancetype)mj_setKeyValues:(id)keyValues context:(NSManagedObjectContext *)contextè¿™ä¸ªæ–¹æ³•ã€‚æˆ‘ä»¬æŠŠå¤–éƒ¨çš„å­—å…¸ï¼Œjsonä¼ å…¥ï¼Œæœ€ç»ˆæŠŠå­—å…¸çš„keyæ˜ å°„åˆ°å¯¹åº”çš„å±æ€§ä¸Šï¼Œvalueæˆä¸ºè¿™ä¸ªå±æ€§çš„å€¼ã€‚</span></div><h3>å‚æ•°è¿‡æ»¤</h3><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">ç¬¬ä¸€æ­¥è‚¯å®šæ˜¯å¯¹å‚æ•°åˆæ³•æ€§è¿›è¡Œæ ¡éªŒã€‚</span></div><pre><code> keyValues = [keyValues mj_JSONObject];<br/><br/>Â Â Â  MJExtensionAssertError([keyValues isKindOfClass:[NSDictionary class]], self, [self class], @&quot;keyValueså‚æ•°ä¸æ˜¯ä¸€ä¸ªå­—å…¸&quot;);</code></pre><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">ç»è¿‡è½¬æ¢åè¿˜ä¸æ˜¯å­—å…¸ç±»å‹å°±ç›´æ¥æŠ›å‡ºå¼‚å¸¸ã€‚</span></div><h3>é»‘åå•ï¼Œç™½åå•è¿‡æ»¤</h3><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">æ¥ä¸‹æ¥å¦‚æœä½¿ç”¨è€…é…ç½®äº†å±æ€§çš„ç™½åå•æˆ–è€…é»‘åå•ï¼Œåˆ™ä¼šå¯¹å–å‡ºé»‘ç™½åå•ã€‚åœ¨éå†ç±»çš„å±æ€§çš„æ—¶å€™è¿‡æ»¤æ‰ã€‚</span></div><pre><code><font color="#0433ff"> NSArray *allowedPropertyNames = [clazz mj_totalAllowedPropertyNames];<br/> NSArray *ignoredPropertyNames = [clazz mj_totalIgnoredPropertyNames];</font></code></pre><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">å› ä¸ºå±æ€§åˆ—è¡¨æ˜¯åœ¨ç±»å¯¹è±¡ä¸Šï¼Œæ‰€ä»¥è‡ªç„¶å»NSObject+MJClass.hè°ƒç”¨ã€‚è¿™ä¸ªç±»ä¸»è¦åŠŸèƒ½å°±æ˜¯æä¾›äº†é»‘ç™½åå•çš„å­˜å‚¨ã€‚</span></div><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">NSObject+MJClass.hä¸­å­˜å‚¨çš„é»‘ç™½åå•</span></div><pre><code><font color="#0433ff">static const char MJAllowedPropertyNamesKey = '\0'; ç™½åå•<br/>static const char MJIgnoredPropertyNamesKey = '\0'; é»‘åå•<br/>static const char MJAllowedCodingPropertyNamesKey = '\0'; å½’æ¡£ç™½åå•<br/>static const char MJIgnoredCodingPropertyNamesKey = '\0'; å½’æ¡£é»‘åå•</font></code></pre><h3>éå†ç±»çš„æ‰€æœ‰å±æ€§</h3><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">æ¥ä¸‹æ¥å°±æ˜¯å¯¹ç±»çš„æ¯ä¸ªå±æ€§å¤„ç†ï¼Œæ¯”å¦‚æ›¿æ¢ï¼Œå¿½ç•¥ç­‰ã€‚æ¶‰åŠåˆ°å±æ€§çš„æ˜¯åœ¨NSObject+MJProperty.hç±»ä¸­å®Œæˆçš„ã€‚æ¯”å¦‚éå†å°±æ˜¯ã€‚</span></div><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">é€šè¿‡ä¼ å…¥block,åœ¨éå†çš„åŒæ—¶å¯¹å±æ€§å°±è¡Œå¤„ç†ã€‚å½¢å¼å°±åƒé€šè¿‡enumerateObjectsUsingBlock:éå†ã€‚</span></div><pre><code><font color="#0433ff">[someArray enumerateObjectsUsingBlock:^(idÂ  _Nonnull obj, NSUInteger idx, BOOL * _Nonnull stop) {<br/><br/>Â Â Â  }]</font></code></pre><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">éå†å±æ€§</span></div><pre><code><span><font color="#0433ff">[clazz mj_enumerateProperties:^<span>(MJProperty *property, BOOL *stop)</span> {<br/>......<br/>}];</font></span></code></pre><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">å¦‚æœå±æ€§åœ¨ç™½åå•æˆ–è€…é»‘åå•ä¸­å‡ºç°åœ¨åˆ™ç›´æ¥è·³å‡ºè¿™æ¬¡å¾ªç¯ã€‚</span></div><pre><code><font color="#0433ff"> if <span>(allowedPropertyNames.count &amp;&amp; ![allowedPropertyNames containsObject:property.name])</span> return;<br/> if <span>([ignoredPropertyNames containsObject:property.name])</span> return;</font></code></pre><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">å–å‡ºå±æ€§å¯¹åº”çš„å€¼ï¼Œå½“ç„¶è¿™é‡Œå¢åŠ äº†å¯¹å€¼å¾—è¿‡æ»¤ï¼Œæ¯”å¦‚è®¾ç½®äº†æ–°å€¼æ›¿æ¢æ—§çš„å€¼ã€‚å¦‚æœæœ€ç»ˆå–å‡ºçš„ç»“æœä¸­æ²¡æœ‰å€¼ï¼Œåˆ™ç›´æ¥è¿”å›ã€‚</span></div><pre><code><font color="#0433ff"> id value;<br/><br/>NSArray *propertyKeyses = [property propertyKeysForClass:clazz];<br/>for (NSArray *propertyKeys in propertyKeyses) {<br/>Â Â Â  value = keyValues;<br/>Â Â Â  for (MJPropertyKey *propertyKey in propertyKeys) {<br/>Â Â Â Â Â Â Â  value = [propertyKey valueInObject:value];<br/>Â Â Â  }<br/>Â Â Â  if (value) break;<br/>}</font><br/><br/><font color="#0433ff">å€¼çš„è¿‡æ»¤<br/>id newValue = [clazz mj_getNewValueFromObject:self oldValue:value property:property];<br/>if (newValue != value) {  æœ‰è¿‡æ»¤åçš„æ–°å€¼<br/>Â Â Â  [property setValue:newValue forObject:self];<br/>Â Â Â  return;<br/>}<br/></font><br/><font color="#0433ff">å¦‚æœæ²¡æœ‰å€¼ï¼Œå°±ç›´æ¥è¿”å›<br/>if (!value || value == [NSNull null]) return;</font></code></pre><div style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph: true; margin-top: 1em; margin-bottom: 1em;">æ¥ä¸‹é‡Œå°±æ˜¯æœ€ç»ˆå¤„ç†éƒ¨åˆ†äº†ã€‚è¿™æ—¶å€™å±æ€§çš„keyå’Œvalueéƒ½æ˜¯åˆæ³•çš„äº†ã€‚</span></div><ul><li>1.å‰©ä¸‹çš„å°±æ˜¯å¤„ç†å±æ€§ã€‚æ¯”å¦‚è®²ä¸å¯å˜æ•°ç»„è½¬ä¸ºå¯å˜æ•°ç»„ã€‚</li><li>2.å¦‚æœä¸æ˜¯Foundationæ¡†æ¶çš„ç±»ï¼Œä¹Ÿå°±æ˜¯ç»§æ‰¿è‡³è‡ªå®šä¹‰æ¨¡å‹çš„éœ€è¦é€’å½’éå†ã€‚</li><li>3.å¯¹æ¨¡å‹æ•°ç»„çš„å¤„ç†</li><li>4.å¦‚æœæ˜¯Foundationæ¡†æ¶ä¸­çš„ã€‚è¿™ä¸ªéƒ¨åˆ†å°±å¯ä»¥ç›´æ¥ç»™valueèµ‹å€¼äº†ã€‚</li><li>5.æœ€ç»ˆKVCç»™å±æ€§èµ‹å€¼ã€‚[property setValue:value forObject:self];</li></ul><div><br/></div><div style="font-family: Menlo; font-size: 10.5pt; -en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><br/></div><div style="font-family: Menlo; font-size: 10.5pt; -en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="direction: ltr; font-family: Menlo; color: rgb(79, 129, 189); margin-top: 1em; margin-bottom: 1em; unicode-bidi: embed; font-size: 10.5pt; -en-paragraph: true; border-width: 100%; font-weight: bold;">ç¬”è®°æ•´ç†ï¼šEdison</span></div><div style="direction: ltr; font-family: Menlo; font-size: 10.5pt; -en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="direction: ltr; font-family: Menlo; font-size: 10.5pt; -en-paragraph: true; margin-top: 1em; margin-bottom: 1em; border-width: 100%; font-weight: bold; color: rgb(79, 129, 189); unicode-bidi: embed;">è”ç³»æ–¹å¼ï¼šQQï¼š277593 ï¼ˆç¬”è®°æ„è§å»ºè®®å¯åŠ æ­¤Qï¼Œä¸“äººæ›´æ–°æ­¤ç¬”è®°ï¼‰ï¼›</span></div><div style="direction: ltr; font-family: Menlo; font-size: 10.5pt; -en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="direction: ltr; font-family: Menlo; font-size: 10.5pt; -en-paragraph: true; margin-top: 1em; margin-bottom: 1em; border-width: 100%; color: rgb(79, 129, 189); unicode-bidi: embed;">Â </span></div><div style="font-family: Menlo; font-size: 10.5pt; -en-paragraph: true; margin-top: 1em; margin-bottom: 1em;"><span style="direction: ltr; font-family: Menlo; color: rgb(79, 129, 189); margin-top: 1em; margin-bottom: 1em; unicode-bidi: embed; font-size: 10.5pt; -en-paragraph: true; border-width: 100%; font-weight: bold;">æ³¨ï¼šå°é“é€”å¾„è·å–åˆ°çš„ç¬”è®°ï¼Œæ— æ³•è‡ªåŠ¨æ›´æ–°ï¼Œè¯·è°…è§£ï¼(ç¬”è®°å¹³å‡æ¯æœˆæ›´æ–°ä¸€æ¬¡ï¼Œç¥å„ä½éƒ½èƒ½æ‹¿åˆ°å¿ƒä»ªçš„offer)</span><span style="direction: ltr; font-family: Menlo; color: rgb(79, 129, 189); margin-top: 1em; margin-bottom: 1em; unicode-bidi: embed; font-size: 10.5pt; -en-paragraph: true; border-width: 100%;">Â </span></div><div><br/></div></span>
</div></body></html> 